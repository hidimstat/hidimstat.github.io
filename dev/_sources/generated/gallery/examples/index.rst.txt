:orphan:

.. _general_examples:

Examples Gallery
================

.. contents:: Contents
   :local:
   :depth: 3



.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to create Partial Dependency Plots (PDPs). This visualization method allows you to examine a model&#x27;s dependence on a single feature or a pair of features. The underlying implementation is built upon sklearn.inspection.partial_dependence, which calculates the dependence by taking the average response of an estimator across all possible values of the target feature(s). We&#x27;ll use the circles dataset to illustrate the basic usage.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_partial_dependency_plot_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_partial_dependency_plot`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Visualization with Partial Dependency Plots</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to measure feature importance using CFI [:footciteChamma_NeurIPS2023] on the wine dataset. The data are the results of chemical analyses of wines grown in the same region in Italy, derived from three different cultivars. Thirteen features are used to predict three types of wine, making this a 3-class classification problem. In this example, we show how to use CFI to identify which variables are most important for solving the classification task with a neural network classifier.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_cfi_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_cfi`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Conditional Feature Importance (CFI) on the wine dataset</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to compare LOCO feature importance [:footciteWilliamson_General_2023] across different predictive models on the same regression dataset. LOCO is model-agnostic and can be applied to any predictive model. Here, we use a linear model, a random forest, a neural network, and a support vector machine. We compare the models based on their predictive performance (R2 score) and the LOCO feature importance they yield.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_loco_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_loco`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Leave-One-Covariate-Out (LOCO) feature importance with different regression models</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example compares the performance of d0crt based on the lasso (1) and random forest (2) implementations. The number of repetitions is set to 10. The metrics used are the type-I error and the power">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_dcrt_example_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_dcrt_example`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Distilled Conditional Randomization Test (dCRT) using Lasso vs Random Forest learners</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we show how to compute variable importance using Permutation Feature Importance (PFI), Leave-One-Covariate-Out (LOCO), and Conditional Feature Importance (CFI) on the diabetes dataset. This example also showcases the use how to measure feature importance in a K-Fold cross-validation setting in order to use all the data available.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_diabetes_variable_importance_example_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_diabetes_variable_importance_example`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Feature Importance on diabetes dataset using cross-validation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates on XOR data that variables can be conditionally important even if they are not marginally important. The conditional importance is computed using the Conditional Feature Importance (CFI) class and the marginal importance is computed using univariate models.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_conditional_vs_marginal_xor_data_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_conditional_vs_marginal_xor_data`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Conditional vs Marginal Importance on the XOR dataset</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we illustrate the limitations of variable selection methods based on linear models using the circles dataset. We first use the distilled conditional randomization test (d0CRT), which is based on linear models :footciteliu2022fast and then demonstrate how model-agnostic methods, such as Leave-One-Covariate-Out (LOCO), can identify important variables even when classes are not linearly separable.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_model_agnostic_importance_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_model_agnostic_importance`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Variable Selection Under Model Misspecification</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="The examples shows how to use aggregate model-X Knockoff selections to derandomize inference. The model-X Knockoff introduced by :footcitecandes2018panning allows for variable selection with statistical guarantees on the False Discovery Rate (FDR),">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_knockoff_aggregation_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_knockoff_aggregation`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Knockoff aggregation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to apply the distilled conditional randomization test (D0CRT) to logistic regression. The hidimstat package implements the decorrelation method described in :footcitenguyen2022conditional, which ensures that the distribution of the test statistic under the null hypothesis closely approximates a standard Gaussian distribution. We illustrate this property by comparing the quantiles of the test statistics obtained using this method (dCRT-logit) with those from the original D0CRT.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_dcrt_logit_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_dcrt_logit`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Conditional Randomization Test for Sparse Logistic Regression</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Pixel-wise inference on digit classification">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_digits_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_digits`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Pixel-wise inference on digit classification</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example compares methods based on Desparsified Lasso (DL) to estimate voxel activation maps associated with behavior, specifically decoder map support. All methods presented here provide statistical guarantees.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_fmri_data_example_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_fmri_data_example`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Support Recovery on fMRI Data</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we explore the basics of variable selection and illustrate the need to statistically control the amount of faslely selected variables. We compare two variable selection methods: the Lasso and the Model-X Knockoffs :footcitecandes2018panning. We show how the Lasso is not robust to the presence of irrelevant variables, while the Knockoffs (KO) method is able to address this issue.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_knockoffs_wisconsin_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_knockoffs_wisconsin`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Controlled multiple variable selection on the Wisconsin breast cancer dataset</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we show on the Iris dataset how to measure variable importance for classification tasks. We use two different variable importance methods: Conditional Feature importance (CFI) and Permutation Feature Importance (PFI) with two different classifiers: Logistic Regression (LR) and Support Vector Classifier (SVC). We start by measuring the importance of individual variables and then show how to measure the importance of groups of variables.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_importance_classification_iris_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_importance_classification_iris`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Measuring Individual and Group Variable Importance for Classification</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we illustrate the pitfalls of using permutation feature importance (PFI) on the California housing dataset. PFI measures the importance of a variable. However, it does not measure conditional importance and does not provide statistical control over the risk of making false discoveries, i.e., the risk of declaring a variable as important when it is not.">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_pitfalls_permutation_importance_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_pitfalls_permutation_importance`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Pitfalls of Permutation Feature Importance (PFI) on the California Housing Dataset</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we present how to perform inference on simulated 2D data. This setting is particularly challenging since the number of features (pixels in 2D) is much larger than the number of samples. We first illustrate the limitations of the Desparsified Lasso method in this setting and then present two methods that leverage the data&#x27;s spatial structure to build clusters and perform the inference at the cluster level. We first show how to use clustered inference with DL (hidimstat.CluDL). We then show how to use clustered inference with Ensembled CluDL (hidimstat.EnCluDL).">

.. only:: html

  .. image:: /generated/gallery/examples/images/thumb/sphx_glr_plot_2D_simulation_example_thumb.png
    :alt:

  :doc:`/generated/gallery/examples/plot_2D_simulation_example`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Ensemble Clustered Inference on 2D Data</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /generated/gallery/examples/plot_partial_dependency_plot
   /generated/gallery/examples/plot_cfi
   /generated/gallery/examples/plot_loco
   /generated/gallery/examples/plot_dcrt_example
   /generated/gallery/examples/plot_diabetes_variable_importance_example
   /generated/gallery/examples/plot_conditional_vs_marginal_xor_data
   /generated/gallery/examples/plot_model_agnostic_importance
   /generated/gallery/examples/plot_knockoff_aggregation
   /generated/gallery/examples/plot_dcrt_logit
   /generated/gallery/examples/plot_digits
   /generated/gallery/examples/plot_fmri_data_example
   /generated/gallery/examples/plot_knockoffs_wisconsin
   /generated/gallery/examples/plot_importance_classification_iris
   /generated/gallery/examples/plot_pitfalls_permutation_importance
   /generated/gallery/examples/plot_2D_simulation_example


.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-gallery

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download all examples in Python source code: examples_python.zip </generated/gallery/examples/examples_python.zip>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download all examples in Jupyter notebooks: examples_jupyter.zip </generated/gallery/examples/examples_jupyter.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
