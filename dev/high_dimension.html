
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7. Inference in high dimension &#8212; HiDimStat</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=0bafa6c9"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=97f0b27d"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'high_dimension';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/mind-inria/hidimstat/refs/heads/main/docs/tools/version.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.3.1.dev15+gafb14a9e0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples Gallery" href="generated/gallery/examples/index.html" />
    <link rel="prev" title="6. Measuring the importance of feature groups" href="grouping.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="HiDimStat - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="HiDimStat - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="generated/gallery/examples/index.html">
    Examples Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="glossary_and_notations.html">
    Glossary and Notations
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="whats_news/whats_news.html">
    What’s new
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="dev/index.html">
    Developer Documentation
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mind-inria/hidimstat" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="generated/gallery/examples/index.html">
    Examples Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="glossary_and_notations.html">
    Glossary and Notations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="whats_news/whats_news.html">
    What’s new
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="dev/index.html">
    Developer Documentation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mind-inria/hidimstat" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="concepts.html">1. General concepts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="concepts/general_concepts.html">1.1. Definition of concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts/statistical_guarantees.html">1.2. Statistical guarantees for variable selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts/glm_coefficient.html">1.3. Generalized Linear Model (GLM) Coefficient</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts/total_sobol_index.html">1.4. Generalized Total Sobol Index</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="slm_methods.html">2. Sparse Linear Models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="model_agnostic_methods.html">3. Model-agnostic methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="model_agnostic_methods/conditional_feature_importance.html">3.1. Conditional Feature Importance</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_agnostic_methods/permutation_feature_importance.html">3.2. Permutation Feature Importance</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_agnostic_methods/leave_one_covariate_out.html">3.3. Leave-One-Covariate-Out</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="marginal_methods.html">4. Marginal methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="marginal_methods/leave_one_covariate_in.html">4.1. Leave-One-Covariate-In</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">5. Tools for visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="grouping.html">6. Measuring the importance of feature groups</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. Inference in high dimension</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="user_guide.html" class="nav-link">User guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis"><span class="section-number">7. </span>Inference in high dimension</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="inference-in-high-dimension">
<span id="high-dimension"></span><h1><span class="section-number">7. </span>Inference in high dimension<a class="headerlink" href="#inference-in-high-dimension" title="Link to this heading">#</a></h1>
<section id="naive-inference-in-high-dimension-is-ill-posed">
<h2><span class="section-number">7.1. </span>Naive inference in high dimension is ill-posed<a class="headerlink" href="#naive-inference-in-high-dimension-is-ill-posed" title="Link to this heading">#</a></h2>
<p>In some cases, data represent high-dimensional measurements of some phenomenon
of interest (e.g. imaging or genotyping). The common characteristic of these
problems is to be very high-dimensional and lead to correlated features. Both
aspects are clearly detrimental to conditional inference, making it both
expensive and powerless:</p>
<ul class="simple">
<li><p>Expensive: most learers are quadratic or cubic in the number of features.
Moreover per-feature inference generally entails a loop over features</p></li>
<li><p>powerless: As dimensionality and correlation increase, it  becomes harder
and harder to isolate the contribution of each variable, meaning that
conditional inference is ill-posed.</p></li>
</ul>
<p>This is illustrated in the above example, where the Desparsified Lasso
(<a class="reference internal" href="generated/api/class/hidimstat.DesparsifiedLasso.html#hidimstat.DesparsifiedLasso" title="hidimstat.DesparsifiedLasso"><code class="xref py py-class docutils literal notranslate"><span class="pre">hidimstat.DesparsifiedLasso</span></code></a>) struggles
to identify relevant features. We need some data to start:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi_size</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># size of the edge of the four predictive regions</span>

<span class="go"># generating the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hidimstat._utils.scenario</span><span class="w"> </span><span class="kn">import</span> <span class="n">multivariate_simulation_spatial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_init</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="n">multivariate_simulation_spatial</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">n_samples</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">roi_size</span><span class="p">,</span> <span class="n">signal_noise_ratio</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">smooth_X</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we perform inference on this data using the Desparsified Lasso:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hidimstat.desparsified_lasso</span><span class="w"> </span><span class="kn">import</span> <span class="n">DesparsifiedLasso</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlasso</span> <span class="o">=</span> <span class="n">DesparsifiedLasso</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_init</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlasso</span><span class="o">.</span><span class="n">importance</span><span class="p">(</span><span class="n">X_init</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># compute importance score and associated</span>
<span class="go">    corrected p-values</span>

<span class="go"># compute estimated support</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">.05</span> <span class="c1"># alpha is the significance level for the statistical test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected_dl</span> <span class="o">=</span> <span class="n">dlasso</span><span class="o">.</span><span class="n">pvalues_</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">true_support</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Desparsified Lasso selected </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">selected_dl</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">true_support</span><span class="p">)</span><span class="si">}</span>
<span class="go">    features among {np.sum(true_support)} &#39;)</span>
<span class="go">Desparsified Lasso selected 19 features among 64</span>
</pre></div>
</div>
</section>
<section id="feature-grouping-and-its-shortcomings">
<h2><span class="section-number">7.2. </span>Feature Grouping and its shortcomings<a class="headerlink" href="#feature-grouping-and-its-shortcomings" title="Link to this heading">#</a></h2>
<p>As discussed earlier, feature grouping is a meaningful solution to deal with
such cases: it reduces the number of features to condition on, and generally
also decreases the level of correlation between features.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="grouping.html#grouping"><span class="std std-ref">Grouping documentation</span></a></p></li>
</ul>
</div>
<p>As hinted in Nicolai Meinshausen and Buhlmann<a class="footnote-reference brackets" href="#footcite-meinshausen2009pvalues" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> an efficient way to deal
with such configuration is to take the per-group average of the features:
this leads to a <em>reduced design</em>. After inference, all the feature in a given
group obtain the p-value of the group representative. When the inference
engine is Desparsified Lasso, the resulting method is called Clustered
Desparsified lasso, or <a class="reference internal" href="generated/api/class/hidimstat.CluDL.html#hidimstat.CluDL" title="hidimstat.CluDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">hidimstat.CluDL</span></code></a>.</p>
<p>Using the same example as previously, we start by defining a clustering
method that will perform the grouping. For image data, Ward clustering is a
good default model, because it takes into account the neighboring structure
among pixels, which avoids creating overly messy clusters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction</span><span class="w"> </span><span class="kn">import</span> <span class="n">image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureAgglomeration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connectivity</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">grid_to_graph</span><span class="p">(</span><span class="n">n_x</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_y</span><span class="o">=</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ward</span> <span class="o">=</span> <span class="n">FeatureAgglomeration</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="n">connectivity</span><span class="p">,</span> <span class="n">linkage</span><span class="o">=</span><span class="s2">&quot;ward&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Equipped with this, we can use CluDL:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hidimstat</span><span class="w"> </span><span class="kn">import</span> <span class="n">CluDL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LassoCV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cludl</span> <span class="o">=</span> <span class="n">CluDL</span><span class="p">(</span>
<span class="go">    clustering=ward,</span>
<span class="go">    desparsified_lasso=DesparsifiedLasso(estimator=LassoCV()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cludl</span><span class="o">.</span><span class="n">fit_importance</span><span class="p">(</span><span class="n">X_init</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go"># compute estimated support</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected_cdl</span> <span class="o">=</span> <span class="n">cludl</span><span class="o">.</span><span class="n">fwer_selection</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n_tests</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Clustered Desparsified Lasso selected</span>
<span class="go">    {np.sum(selected_cdl *  true_support)} features among</span>
<span class="go">    {np.sum(true_support)}&#39;)</span>
<span class="go">Clustered Desparsified Lasso selected 51 features among 64</span>
</pre></div>
</div>
<p>Note that inference is also way faster on the compressed representation.</p>
<p>The issue is that  very-high-dimensional data (biological, images, etc.) do
not have any canonical grouping structure. Hence, they rely on grouping
obtained from the data, typically with clustering technique. However, the
resulting clusters bring some undesirable randomness. Think that imputing
slightly different data would lead to different clusters. Since there is no
globally optimal clustering, the wiser solution is to <em>average</em> the results
across clusterings. Since it may not be a good idea to average p-values, an
alternative <em>ensembling</em> or  <em>aggregation</em> strategy is used instead. When the
inference engine is Desparsified Lasso, the resulting method is called
Ensemble of Clustered Desparsified lasso, or <a class="reference internal" href="generated/api/class/hidimstat.EnCluDL.html#hidimstat.EnCluDL" title="hidimstat.EnCluDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">hidimstat.EnCluDL</span></code></a>.</p>
<p>The behavior is illustrated here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hidimstat</span><span class="w"> </span><span class="kn">import</span> <span class="n">EnCluDL</span>

<span class="go"># ensemble of clustered desparsified lasso (EnCluDL)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encludl</span> <span class="o">=</span> <span class="n">EnCluDL</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">clustering</span><span class="o">=</span><span class="n">ward</span><span class="p">,</span>
<span class="go">        desparsified_lasso=DesparsifiedLasso(estimator=LassoCV()),</span>
<span class="go">        n_bootstraps=20,</span>
<span class="go">        random_state=0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encludl</span><span class="o">.</span><span class="n">fit_importance</span><span class="p">(</span><span class="n">X_init</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected_ecdl</span> <span class="o">=</span> <span class="n">encludl</span><span class="o">.</span><span class="n">fwer_selection</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n_tests</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ensemble of Clustered Desparsified Lasso selected</span>
<span class="go">    {np.sum(selected_ecdl *  true_support)} features among</span>
<span class="go">    {np.sum(true_support)} &#39;)</span>
<span class="go">Ensemble of Clustered Desparsified Lasso selected 57 features among 64</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title"><strong>Full example</strong></p>
<p>See the following example for a full file running the analysis:
<a class="reference internal" href="generated/gallery/examples/plot_2D_simulation_example.html#sphx-glr-generated-gallery-examples-plot-2d-simulation-example-py"><span class="std std-ref">Ensemble Clustered Inference on 2D Data</span></a></p>
</aside>
</section>
<section id="what-type-of-control-does-this-ensemble-of-clustered-inference-come-with">
<h2><span class="section-number">7.3. </span>What type of Control does this Ensemble of CLustered inference come with ?<a class="headerlink" href="#what-type-of-control-does-this-ensemble-of-clustered-inference-come-with" title="Link to this heading">#</a></h2>
<p>Ensemble of Clustered Inference is not a local method, so control cannot be
maintained at each brain site in isolation. The notion of a false positive
must be mitigated by the non-local characteristic of the inference performed.
Thus, we introduce the concept of a <span class="math notranslate nohighlight">\(\delta\)</span>-false positive:
A detection is a delta-false positive if it is at a distance greater than
<span class="math notranslate nohighlight">\(\delta\)</span> from the support, which is the set of true positives.
Thus, what is controlled is the <span class="math notranslate nohighlight">\(\delta\)</span>-FWER, i.e., the probability of
reporting a single <span class="math notranslate nohighlight">\(\delta\)</span>-false positive.
In other words, EnCluDL will likely only report detections at a distance less
than <span class="math notranslate nohighlight">\(\delta\)</span> from the true support.</p>
<p>What is <span class="math notranslate nohighlight">\(\delta\)</span> ? It is the diameter of the clusters used in the CluDL
procedure.</p>
<p>The details of the method and the underlying guarantees are described in
Chevalier <em>et al.</em><a class="footnote-reference brackets" href="#footcite-chevalier2022spatially" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<aside class="topic">
<p class="topic-title"><strong>Other examples</strong></p>
<p>See the following example for an application to the analysis of fMRI data:
<a class="reference internal" href="generated/gallery/examples/plot_fmri_data_example.html#sphx-glr-generated-gallery-examples-plot-fmri-data-example-py"><span class="std std-ref">Support Recovery on fMRI Data</span></a></p>
<p>See this example for an illustration on MNIST digit classification:
<a class="reference internal" href="generated/gallery/examples/plot_digits.html#sphx-glr-generated-gallery-examples-plot-digits-py"><span class="std std-ref">Pixel-wise inference on digit classification</span></a></p>
</aside>
</section>
<section id="references">
<h2><span class="section-number">7.4. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id3">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-meinshausen2009pvalues" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Lukas Meier Nicolai Meinshausen and Peter Buhlmann. P-values for high-dimensional regression. <em>Journal of the American Statistical Association</em>, 104(488):1671–1681, 2009. <a class="reference external" href="https://doi.org/10.1198/jasa.2009.tm08647">doi:10.1198/jasa.2009.tm08647</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-chevalier2022spatially" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Jérôme-Alexis Chevalier, Tuan-Binh Nguyen, Bertrand Thirion, and Joseph Salmon. Spatially relaxed inference on high-dimensional linear models. <em>Statistics and Computing</em>, 32(5):83, 2022.</p>
</aside>
</aside>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="grouping.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Measuring the importance of feature groups</p>
      </div>
    </a>
    <a class="right-next"
       href="generated/gallery/examples/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Examples Gallery</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-inference-in-high-dimension-is-ill-posed">7.1. Naive inference in high dimension is ill-posed</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-grouping-and-its-shortcomings">7.2. Feature Grouping and its shortcomings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-type-of-control-does-this-ensemble-of-clustered-inference-come-with">7.3. What type of Control does this Ensemble of CLustered inference come with ?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">7.4. References</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/high_dimension.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The hidimstat developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>